<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="3168px" height="2791px" viewBox="-0.5 -0.5 3168 2791" content="&lt;mxfile host=&quot;www.draw.io&quot; modified=&quot;2020-02-23T21:13:18.246Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36&quot; etag=&quot;5BVI4RgjcWvOHyFT7sm6&quot; version=&quot;12.7.2&quot; type=&quot;github&quot;&gt;&lt;diagram id=&quot;C5RBs43oDa-KdzZeNtuy&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" resource="https://www.draw.io/#Hwire-mistry%2FAOSP_Gaphics%2Fmaster%2FSurface%20Flinger.svg"><defs/><g><path d="M 132 199 L 132 229 L 157 229 L 157 248.88" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 157 257.88 L 152.5 248.88 L 161.5 248.88 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="47" y="169" width="170" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 184px; margin-left: 48px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">SurfaceFlinger::OnTransact {Binder call 1006} Calls</div></div></div></foreignObject><text x="132" y="188" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">SurfaceFlinger::OnTransact {...</text></switch></g><path d="M 157 289 L 157 362.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 157 367.88 L 153.5 360.88 L 157 362.63 L 160.5 360.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="67" y="259" width="180" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 274px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">signalRefresh()</div></div></div></foreignObject><text x="157" y="278" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">signalRefresh()</text></switch></g><path d="M 157 399 L 157 439 L 177 439 L 177 472.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 177 477.88 L 173.5 470.88 L 177 472.63 L 180.5 470.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="67" y="369" width="180" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 384px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">mEventQueue-&gt;Refersh()</div></div></div></foreignObject><text x="157" y="388" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mEventQueue-&gt;Refersh()</text></switch></g><path d="M 177 539 L 177 559 L 177 549 L 177 562.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 177 567.88 L 173.5 560.88 L 177 562.63 L 180.5 560.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="67" y="479" width="220" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 509px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MessageQueue has a handler object , and Refresh() calls handler's <br />dispatchRefresh()</div></div></div></foreignObject><text x="177" y="513" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">MessageQueue has a handler object ,...</text></switch></g><path d="M 177 629 L 177 702.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 177 707.88 L 173.5 700.88 L 177 702.63 L 180.5 700.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="67" y="569" width="220" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 599px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">dispatchRefresh() is wrapper for messageQueue's looper's sendMessage()</div></div></div></foreignObject><text x="177" y="603" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">dispatchRefresh() is wrapper for mes...</text></switch></g><path d="M 177 769 L 177 842.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 177 847.88 L 173.5 840.88 L 177 842.63 L 180.5 840.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="67" y="709" width="220" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 739px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">The sendMessage of messageQueue :: looper is responded by handleMessage of messageQueue. </div></div></div></foreignObject><text x="177" y="743" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">The sendMessage of messageQueue :: l...</text></switch></g><rect x="67" y="849" width="220" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 879px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleMessage of messageQueue call's OnMessageReceived of surface Flinger</div></div></div></foreignObject><text x="177" y="883" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">handleMessage of messageQueue call's...</text></switch></g><rect x="17" y="99" width="600" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 598px; height: 1px; padding-top: 119px; margin-left: 18px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">&lt;Comment&gt; This Signal Refresh is called inside the onMessageReceived() function of surface flinger, it may seem like cyclic loop But there are checks for bootstage:BOOTLOADER, yet to be explored</div></div></div></foreignObject><text x="317" y="123" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">&lt;Comment&gt; This Signal Refresh is called inside the onMessageReceived() function of surface flinger,...</text></switch></g><path d="M 307 359 L 307 384 L 253.37 384" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 248.12 384 L 255.12 380.5 L 253.37 384 L 255.12 387.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 247 306.5 C 199 306.5 187 324 225.4 327.5 C 187 335.2 230.2 352 261.4 345 C 283 359 355 359 379 345 C 427 345 427 331 397 324 C 427 310 379 296 337 303 C 307 292.5 259 292.5 247 306.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 324px; margin-left: 188px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">mEventQueue is <br />MessageQueue object</div></div></div></foreignObject><text x="307" y="328" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mEventQueue is...</text></switch></g><path d="M 307 674 L 232 674 L 232 702.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 232 707.88 L 228.5 700.88 L 232 702.63 L 235.5 700.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 307 624 L 517 624 L 517 694 L 432 694 L 412 724 L 412 694 L 307 694 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 659px; margin-left: 308px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Hope Fully some day will solve the magic of How looper-&gt;sendMessage  of message queue calls handle message of messge queue</div></div></div></foreignObject><text x="412" y="663" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Hope Fully some day will solve the...</text></switch></g><path d="M 307 674 L 232 674 L 232 635.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 232 630.12 L 235.5 637.12 L 232 635.37 L 228.5 637.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 447 204 L 332 204 L 332 191.5 L 223.37 191.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 218.12 191.5 L 225.12 188 L 223.37 191.5 L 225.12 195 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 637 259 L 637 332.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="stroke"/><path d="M 637 337.88 L 633.5 330.88 L 637 332.63 L 640.5 330.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="149" width="380" height="110" rx="16.5" ry="16.5" fill="#ffffff" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 378px; height: 1px; padding-top: 204px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">As like every other onTransact, this too has to be called by some binder , and this biner initiation is object is taken by taking the "SurfaceFlinger" service in SurfaceComposerClient.cpp @ function connectLocked() of ComposerService class. <br />Note: ComposorClient inherits singleton class  hence get instance method is available directly to composerClitent: Link2</div></div></div></foreignObject><text x="637" y="208" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">As like every other onTransact, this too has to be called by so...</text></switch></g><path d="M 637 449 L 637 469 L 877 469 L 877 472.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="stroke"/><path d="M 877 477.88 L 873.5 470.88 L 877 472.63 L 880.5 470.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="339" width="380" height="110" rx="16.5" ry="16.5" fill="#ffffff" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 378px; height: 1px; padding-top: 394px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">This binder us usually used to setup transactions and does no gives any signalrefresh or a message which may hint surface flinger to start compositing.<br />Hence we can say the calls ontransact calls of surface flinger is used to  debug the surface flinger and hence the composition of handling on vsync period is done at diffrent place. As <a href="https://www.slideshare.net/hungys/project-meeting-android-graphics-architecture-overview">this</a>(Link1) link suggests  is done through some call back of harware composer's generation on vsync and hence following on that line Starting with link3</div></div></div></foreignObject><text x="637" y="398" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">This binder us usually used to setup transactions and does no g...</text></switch></g><path d="M 877 659 L 877 674.5 L 867 674.5 L 867 683.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 867 688.88 L 863.5 681.88 L 867 683.63 L 870.5 681.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="607" y="489" width="540" height="160" rx="14.4" ry="14.4" fill="#ffffff" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 538px; height: 1px; padding-top: 569px; margin-left: 608px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span>Hence, Lets fall back to who generates the vsync events for All,</span></div><div>As per the image of <a href="https://source.android.com/devices/graphics/implement-vsync">Android Developers</a> figure 1, based on hw_vsync_0 the <a href="https://android.googlesource.com/platform/frameworks/native/+/android-7.1.1_r28/services/surfaceflinger/DispSync.cpp">Dispsync</a>.cpp generates the vsync(for apps to create the next frame) and sf_vsync(for sf to compose next frame on disp). The MISTRY OF HOW HW_VSYNC REACHES TO DISPSYNC ? still stays but  lets starts how dispsync takes care from fruther. Other tasks of DispSync can be read at android developers.</div><div><br /></div><div>There is threadLoop() in DispSync lets strat from that </div><div><br /></div><div><b>DispSyncThread::threadLoop()</b></div><div>If the checks of if(now &lt; target time) fails and  callbackInvocations  at availible i.e. size is not zero it calls</div></div></div></div></foreignObject><text x="877" y="573" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Hence, Lets fall back to who generates the vsync events for All,...</text></switch></g><path d="M 867 760 L 867 780 L 617 780 L 617 793.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 617 798.88 L 613.5 791.88 L 617 793.63 L 620.5 791.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="617" y="700" width="500" height="50" rx="14" ry="14" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 498px; height: 1px; padding-top: 725px; margin-left: 618px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: justify"><span class="pln" style="box-sizing: border-box ; margin: 0px ; padding: 0px ; font-family: &quot;source code pro&quot; , monospace ; font-size: 13.3333px ; white-space: pre ; background-color: rgb(255 , 255 , 255)">fireCallbackInvocations</span><span class="pun" style="box-sizing: border-box ; margin: 0px ; padding: 0px ; color: rgb(102 , 102 , 0) ; font-family: &quot;source code pro&quot; , monospace ; font-size: 13.3333px ; white-space: pre ; background-color: rgb(255 , 255 , 255)">(</span><span class="pln" style="box-sizing: border-box ; margin: 0px ; padding: 0px ; font-family: &quot;source code pro&quot; , monospace ; font-size: 13.3333px ; white-space: pre ; background-color: rgb(255 , 255 , 255)">callbackInvocations</span><span class="pun" style="box-sizing: border-box ; margin: 0px ; padding: 0px ; color: rgb(102 , 102 , 0) ; font-family: &quot;source code pro&quot; , monospace ; font-size: 13.3333px ; white-space: pre ; background-color: rgb(255 , 255 , 255)">);</span><br /></div><div style="text-align: justify"><span class="pun" style="box-sizing: border-box ; margin: 0px ; padding: 0px ; color: rgb(102 , 102 , 0) ; font-family: &quot;source code pro&quot; , monospace ; font-size: 13.3333px ; white-space: pre ; background-color: rgb(255 , 255 , 255)"><span style="color: rgb(0 , 0 , 0) ; font-size: 13.3333px">this function envokes all the callbacks onDispSyncEvent</span><br /></span></div></div></div></div></foreignObject><text x="867" y="729" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">fireCallbackInvocations(callbackInvocations);...</text></switch></g><path d="M 617 870 L 617 923.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 617 928.88 L 613.5 921.88 L 617 923.63 L 620.5 921.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="810" width="340" height="50" rx="4" ry="4" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 835px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: justify">DispSyncSource::onDispSyncEvents() &lt;DispSyncSource inherits Callback class&gt;  class Callback has onDispSyncEvents as virtual fucntion</div></div></div></div></foreignObject><text x="617" y="839" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DispSyncSource::onDispSyncEvents() &lt;DispSyncSource inher...</text></switch></g><path d="M 617 1000 L 617 1053.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 617 1058.88 L 613.5 1051.88 L 617 1053.63 L 620.5 1051.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="940" width="340" height="50" rx="4" ry="4" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 965px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: justify">DispSyncSource:OnDispSyncEvents calls VsyncSource::onVsyncEvent() VsyncSource is defined in EventThread.h i.e. the call is to EventThread::OnvsyncEvent</div></div></div></div></foreignObject><text x="617" y="969" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DispSyncSource:OnDispSyncEvents calls VsyncSource::onVsy...</text></switch></g><path d="M 617 1130 L 617 1160 L 692 1160 L 692 1183.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 692 1188.88 L 688.5 1181.88 L 692 1183.63 L 695.5 1181.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="1070" width="340" height="50" rx="4" ry="4" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 1095px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: justify">EventThread::OnVsyncEvent()</div><div style="text-align: justify">This function does mCondition.notify_alll()</div></div></div></div></foreignObject><text x="617" y="1099" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">EventThread::OnVsyncEvent()...</text></switch></g><path d="M 692 1330 L 692 1383.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 692 1388.88 L 688.5 1381.88 L 692 1383.63 L 695.5 1381.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="1200" width="490" height="120" rx="9.6" ry="9.6" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 1260px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">The split in algorithm, In the thread main of EventThread::threadMain() there is wait on mCondition.wait_for, and this wait is completed with the call to mCondition.notify_all and the completion calls</div></div></div></foreignObject><text x="692" y="1264" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">The split in algorithm, In the thread main of EventThread::threadMain() there is...</text></switch></g><path d="M 267 1570 L 692 1570 L 692 1583.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 692 1588.88 L 688.5 1581.88 L 692 1583.63 L 695.5 1581.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="1400" width="490" height="120" rx="9.6" ry="9.6" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 1460px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">mPendingEvents.push_back(DisplayEventReceiver::Event::makeVsync()),  mPendingEvents is a queue of type DisplayEventReceiver::Event.</div></div></div></foreignObject><text x="692" y="1464" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mPendingEvents.push_back(DisplayEventReceiver::Event::makeVsync()),  mPendingEven...</text></switch></g><path d="M 692 1730 L 692 1760 L 697 1760 L 697 1783.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 697 1788.88 L 693.5 1781.88 L 697 1783.63 L 700.5 1781.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="1600" width="490" height="120" rx="9.6" ry="9.6" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 1660px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">The /surfaceflinger/schedular/MessageQueue has  a function called setEventThread( which is called by surfaceFlinger when VsyncInjections are enabled).setEventThread does a call to <br />mLooper-&gt;addfd(mEventTube.getfd,0,Looper::EVENT_INPUT::MessageQueue:cb_eventReceiver,this)<br />This call might register it as a call back function, which executes preodically.</div></div></div></foreignObject><text x="692" y="1664" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">The /surfaceflinger/schedular/MessageQueue has  a function called setEventThread(...</text></switch></g><path d="M 697 1880 L 697 1910 L 722.5 1910 L 722.5 1933.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 722.5 1938.88 L 719 1931.88 L 722.5 1933.63 L 726 1931.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="447" y="1800" width="500" height="70" rx="5.6" ry="5.6" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 498px; height: 1px; padding-top: 1835px; margin-left: 448px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MessageQueue:cb_eventReceiver()<br />calls<br />MessageQueue::eventReceiver()<br /></div></div></div></foreignObject><text x="697" y="1839" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">MessageQueue:cb_eventReceiver()...</text></switch></g><path d="M 722.5 2100 L 722.5 2153.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 722.5 2158.88 L 719 2151.88 L 722.5 2153.63 L 726 2151.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="448" y="1950" width="549" height="140" rx="11.2" ry="11.2" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 547px; height: 1px; padding-top: 2020px; margin-left: 449px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MessageQueue::eventReceiver()<br />Has a function Get DisplayEventReceiver's event<br />DisplayEventReceiver::getEvent()<br />if the event is of type DISPLAY_EVENT_VSYNC <br />then<br />mHandler.dispatchInvalidate() is called.<br /></div></div></div></foreignObject><text x="723" y="2024" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">MessageQueue::eventReceiver()...</text></switch></g><path d="M 722.5 2320 L 722.5 2373.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 722.5 2378.88 L 719 2371.88 L 722.5 2373.63 L 726 2371.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="448" y="2170" width="549" height="140" rx="11.2" ry="11.2" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 547px; height: 1px; padding-top: 2240px; margin-left: 449px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br />mHandler.dispatchInvalidate() calls <br />mQueue.mLooper-&gt;sendMessage(this,MessageQueue:Refresh)<br /><br />this triggers MessageQueue::handler::HandleMessage function<br /><br />this calls based on INVALIDATE or REFRESH message<br /><br />mQueue.mFlinger-&gt;onMessageReceived(message.what)  message.what = INVALIDATE/Refresh</div></div></div></foreignObject><text x="723" y="2244" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mHandler.dispatchInvalidate() calls...</text></switch></g><path d="M 722.5 2540 L 722.5 2590 L 712 2590 L 712 2633.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 712 2638.88 L 708.5 2631.88 L 712 2633.63 L 715.5 2631.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="448" y="2390" width="549" height="140" rx="11.2" ry="11.2" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 547px; height: 1px; padding-top: 2460px; margin-left: 449px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br />mHandler.dispatchInvalidate() calls <br />mQueue.mLooper-&gt;sendMessage(this,MessageQueue:Refresh)<br /><br />this triggers MessageQueue::handler::HandleMessage function<br /><br />this calls based on INVALIDATE or REFRESH message<br /><br />mQueue.mFlinger-&gt;onMessageReceived(message.what)  message.what = INVALIDATE/Refresh</div></div></div></foreignObject><text x="723" y="2464" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mHandler.dispatchInvalidate() calls...</text></switch></g><rect x="437.5" y="2650" width="549" height="140" rx="11.2" ry="11.2" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 547px; height: 1px; padding-top: 2720px; margin-left: 439px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">mFlinger is surfaceFlingers object hence<br />mQueue.mFlinger-&gt;onMessageReceived(message.what)<br />Triggeres<br />SurfaceFlinger::OnMessageReceived()<br />From this point onwards The further calls are tracible with help on Systrace enabled with tags &lt;<b>gfx</b>, input, sched,freq,<b>view</b>&gt; i.e the tags which will enable surfaceFlinger logs on systrace.</div></div></div></foreignObject><text x="712" y="2724" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">mFlinger is surfaceFlingers object hence...</text></switch></g><path d="M 67 274 L 17 274 Q 7 274 7 264 L 7 129 Q 7 119 8.82 119 L 10.63 119" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="stroke"/><path d="M 15.88 119 L 8.88 122.5 L 10.63 119 L 8.88 115.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><a xlink:href="https://waynewolf.github.io/2014/06/22/surfaceflinger-and-client/"><rect x="687" y="89" width="360" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 96px; margin-left: 689px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Link2:https://waynewolf.github.io/2014/06/22/surfaceflinger-and-client/</div></div></div></foreignObject><text x="689" y="108" fill="#000000" font-family="Helvetica" font-size="12px">Link2:https://waynewolf.github.io/2014/06/22/surfaceflinger-...</text></switch></g></a><rect x="2217" y="149" width="950" height="640" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 156px; margin-left: 2219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Link2:<br /><br />handleMessageRefresh<br />     |—&gt; preComposition<br />     |—&gt; rebuildLayerStacks<br />     |—&gt; setUpHWComposer<br />          |—&gt; HWComposer::createWorkList &lt;== hwc="" structures="" are="" allocated="" |—=""&gt; Layer::setGeometry()<br />          |—  set per frame data<br />          |—  HWComposer::prepare<br />               |—&gt; hwc prepare<br />     |—&gt; doComposition<br />          |---- skip composition on external display if condition meets<br />          |—&gt; doDisplayComposition<br />          |    |—&gt; doComposeSurfaces<br />          |     |—&gt; DisplayDevice::swapBuffers<br />          |          |—&gt; eglSwapBuffers<br />          |          |—&gt; FramebufferSurface::advanceFrame<br />          |—&gt; DisplayDevice::flip(…)     &lt;== just="" update="" statistics="" count="" |--=""&gt; Call DisplayDevice::compositionComplete(), notify each display<br />               |--&gt; DisplaySurface::compositionComplete()<br />                    |--&gt; FramebufferSurface::compositionComplete()<br />                         |--&gt; HWComposer::fbCompositionComplete()<br />                              |--&gt; NoOP if HWC &gt;= 1.1<br />                              |--&gt; used only in framebuffer device case.<br />          |—&gt; postFrameBuffer<br />               |—&gt; HWComposer::commit<br />                    |—&gt; hwc set<br />                    |—&gt; update retireFenceFd of hwc_display_contents_1<br />               |—&gt; DisplayDevice::onSwapBuffersCompleted<br />                    |—&gt; FramebufferSurface::onFrameComitted<br />               |—&gt; Layer::onLayerDisplayed<br />               |—   update some statistics<br />     |—&gt; postComposition</div></div></div></foreignObject><text x="2219" y="168" fill="#000000" font-family="Helvetica" font-size="12px">Link2:...</text></switch></g><a xlink:href="https://waynewolf.github.io/2014/06/22/surfaceflinger-and-client/"><rect x="2007" y="69" width="360" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 76px; margin-left: 2009px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">https://waynewolf.github.io/2014/06/22/surfaceflinger-and-client/</div></div></div></foreignObject><text x="2009" y="88" fill="#000000" font-family="Helvetica" font-size="12px">https://waynewolf.github.io/2014/06/22/surfaceflinger-and-cl...</text></switch></g></a><rect x="447" y="63" width="530" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 73px; margin-left: 712px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Link1 : https://www.slideshare.net/hungys/project-meeting-android-graphics-architecture-overview</div></div></div></foreignObject><text x="712" y="77" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Link1 : https://www.slideshare.net/hungys/project-meeting-android-graphics-architecture-...</text></switch></g><a xlink:href="https://charleszblog.wordpress.com/2014/02/22/understanding-android-internals-surfaceflinger-ii/"><rect x="917" y="119" width="540" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 126px; margin-left: 919px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Link3 :  https://charleszblog.wordpress.com/2014/02/22/understanding-android-internals-surfaceflinger-ii/</div></div></div></foreignObject><text x="919" y="138" fill="#000000" font-family="Helvetica" font-size="12px">Link3 :  https://charleszblog.wordpress.com/2014/02/22/understanding-android-internals-sur...</text></switch></g></a><a xlink:href="https://waynewolf.github.io/2014/07/10/surfaceflinger-and-hwcomposer/"><rect x="957" y="190" width="400" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 197px; margin-left: 959px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Link4 : https://waynewolf.github.io/2014/07/10/surfaceflinger-and-hwcomposer/</div></div></div></foreignObject><text x="959" y="209" fill="#000000" font-family="Helvetica" font-size="12px">Link4 : https://waynewolf.github.io/2014/07/10/surfaceflinger-and-...</text></switch></g></a><a xlink:href="https://www.cnblogs.com/pengdonglin137/articles/5408060.html"><rect x="967" y="280" width="360" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 287px; margin-left: 969px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">https://www.cnblogs.com/pengdonglin137/articles/5408060.html</div></div></div></foreignObject><text x="969" y="299" fill="#000000" font-family="Helvetica" font-size="12px">https://www.cnblogs.com/pengdonglin137/articles/5408060.html</text></switch></g></a><rect x="737" y="10" width="790" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 788px; height: 1px; padding-top: 30px; margin-left: 738px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><h1><b><font style="font-size: 16px">This Is path of discovery of Vsync event sent to Surface flinger, whch ussually covers evry thing</font></b></h1></div></div></div></foreignObject><text x="1132" y="34" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">This Is path of discovery of Vsync event sent to Surface flinger, whch ussually covers evry thing</text></switch></g><path d="M 663.43 1190.71 L 637.09 1121.68 M 640.83 1120.26 L 667.16 1189.29 M 640.83 1120.26" fill="none" stroke="#000000" stroke-linejoin="round" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="1500" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1530px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">This Code split is from the world of surface flinger</div></div></div></foreignObject><text x="277" y="1534" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">This Code split is f...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>